<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pyLCM.perm.perm_1d &mdash; pyLCM: a python package for Liquid Composite Molding 0.0.1 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css\rtd_sphinx_search.min.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
        <script src="../../../_static/js\rtd_sphinx_search.min.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> pyLCM: a python package for Liquid Composite Molding
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"></div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">pyLCM: a python package for Liquid Composite Molding</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../index.html">Module code</a> &raquo;</li>
      <li>pyLCM.perm.perm_1d</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for pyLCM.perm.perm_1d</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>


<div class="viewcode-block" id="flow_dist"><a class="viewcode-back" href="../../../source/pyLCM.perm.html#pyLCM.perm.perm_1d.flow_dist">[docs]</a><span class="k">def</span> <span class="nf">flow_dist</span><span class="p">(</span><span class="n">permeability</span><span class="p">,</span> <span class="n">pressure</span><span class="p">,</span> <span class="n">porosity</span><span class="p">,</span> <span class="n">viscosity</span><span class="p">,</span> <span class="n">time</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the one dimensional flow distance in porous media:</span>
<span class="sd">    distance = sqrt( (2* pressure * permeability * time) / (viscosity * porosity) )</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    permeability: float</span>
<span class="sd">        Permeability of porous media.</span>
<span class="sd">    pressure: float</span>
<span class="sd">        Injection pressure of the fluid.</span>
<span class="sd">    porosity: float</span>
<span class="sd">        Porosity of porous media.</span>
<span class="sd">    viscosity: float</span>
<span class="sd">        Viscosity of the fluid.</span>
<span class="sd">    time: float or list</span>
<span class="sd">        Filling time of porous media.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    one dimensional flow distance</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="mi">2</span> <span class="o">*</span> <span class="n">pressure</span> <span class="o">*</span> <span class="n">permeability</span> <span class="o">*</span> <span class="n">time</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">viscosity</span> <span class="o">*</span> <span class="n">porosity</span><span class="p">))</span></div>


<div class="viewcode-block" id="filling_time"><a class="viewcode-back" href="../../../source/pyLCM.perm.html#pyLCM.perm.perm_1d.filling_time">[docs]</a><span class="k">def</span> <span class="nf">filling_time</span><span class="p">(</span><span class="n">permeability</span><span class="p">,</span> <span class="n">pressure</span><span class="p">,</span> <span class="n">porosity</span><span class="p">,</span> <span class="n">viscosity</span><span class="p">,</span> <span class="n">distance</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    TODO: Check the formulation</span>
<span class="sd">    Calculate the filling time of porous media:</span>
<span class="sd">    fillingTime = (viscosity * porosity * distance^2) / (2 * pressure * permeability)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    permeability: float</span>
<span class="sd">        Permeability of porous media.</span>
<span class="sd">    pressure:</span>
<span class="sd">        Pressure of the fluid.</span>
<span class="sd">    porosity:</span>
<span class="sd">    viscosity:</span>
<span class="sd">    :param distance:</span>
<span class="sd">    :return: filling time</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">viscosity</span> <span class="o">*</span> <span class="n">porosity</span> <span class="o">*</span> <span class="n">distance</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">pressure</span> <span class="o">*</span> <span class="n">permeability</span><span class="p">)</span></div>


<div class="viewcode-block" id="saturated"><a class="viewcode-back" href="../../../source/pyLCM.perm.html#pyLCM.perm.perm_1d.saturated">[docs]</a><span class="k">def</span> <span class="nf">saturated</span><span class="p">(</span><span class="n">volumetric_flow_rate</span><span class="p">,</span> <span class="n">area</span><span class="p">,</span> <span class="n">pressure</span><span class="p">,</span> <span class="n">flow_dist</span><span class="p">,</span> <span class="n">mu</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the saturated one dimensional permeability of porous media according to</span>
<span class="sd">    the Darcy&#39;s law and experimental measured mass flow rate:</span>

<span class="sd">    permeability = (VolumeFlowRate * viscosity * thickness) / (pressure * area * liquidDensity)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        volumetric_flow_rate: array-like</span>
<span class="sd">            Volumetric flow rate of the fluid in m^3/s.</span>
<span class="sd">        area: float</span>
<span class="sd">            Cross-section area perpendicular to the flow in m^2.</span>
<span class="sd">        pressure: float</span>
<span class="sd">            Pressure drop across the porous media in the flow direction in Pa.</span>
<span class="sd">        flow_dist: float</span>
<span class="sd">            Flow distance (sample length along the flow direction) in m.</span>
<span class="sd">        mu: float</span>
<span class="sd">            Viscosity of the fluid in Pa*s.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        one dimensional permeability: m^2</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">volumetric_flow_rate</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">volumetric_flow_rate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">volumetric_flow_rate</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">volumetric_flow_rate</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
        <span class="n">volumetric_flow_rate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">volumetric_flow_rate</span><span class="p">])</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">volumetric_flow_rate</span> <span class="o">*</span> <span class="n">mu</span> <span class="o">*</span> <span class="n">flow_dist</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">pressure</span> <span class="o">*</span> <span class="n">area</span><span class="p">)</span></div>


<div class="viewcode-block" id="unsaturated"><a class="viewcode-back" href="../../../source/pyLCM.perm.html#pyLCM.perm.perm_1d.unsaturated">[docs]</a><span class="k">def</span> <span class="nf">unsaturated</span><span class="p">(</span><span class="n">flow_front</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">Vf</span><span class="p">,</span> <span class="n">pressure</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">skip</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the unsaturated permeability of a porous medium by recording the flow</span>
<span class="sd">    front position and the corresponding filling time. The injection is performed</span>
<span class="sd">    at a constant pressure.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    flow_front : list</span>
<span class="sd">        Flow front position in meter.</span>
<span class="sd">    time : list</span>
<span class="sd">        The time that the flow front position is recorded at the corresponding</span>
<span class="sd">        flow front position. The unit is second.</span>
<span class="sd">    Vf : float</span>
<span class="sd">        The fiber volume fraction of the porous media.</span>
<span class="sd">    pressure : float</span>
<span class="sd">        The pressure difference between the inlet and outlet of the porous media.</span>
<span class="sd">        The unit is Pascal.</span>
<span class="sd">    mu : float</span>
<span class="sd">        The viscosity of the fluid. The unit is Pascal second (Pa·s).</span>
<span class="sd">    skip : int, optional</span>
<span class="sd">        The number of data points to skip at the beginning of the data to cover</span>
<span class="sd">        the fully developed 1d flow only. The default is 0.</span>
<span class="sd">    plot : bool, optional</span>
<span class="sd">        Whether to plot the filling VS square of flow distance. The default is</span>
<span class="sd">        False.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    perm : float</span>
<span class="sd">        The permeability of the porous media. The unit is m^2.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import pyLCM</span>
<span class="sd">    &gt;&gt;&gt; import numpy as np</span>
<span class="sd">    &gt;&gt;&gt; time = [0, 3, 8, 13, 20, 28, 34, 46, 57, 69, \</span>
<span class="sd">            82, 96, 109, 125, 142, 161, 180, 198, \</span>
<span class="sd">            218, 242, 262]</span>
<span class="sd">    &gt;&gt;&gt; flow_front = [0, 0.02, 0.04, 0.06, 0.08, 0.1, \</span>
<span class="sd">                  0.12, 0.14, 0.16, 0.18, 0.20, 0.22, \</span>
<span class="sd">                  0.24, 0.26, 0.28, 0.30, 0.32, 0.34, \</span>
<span class="sd">                  0.36, 0.38, 0.4]</span>
<span class="sd">    &gt;&gt;&gt; Vf = 0.5</span>
<span class="sd">    &gt;&gt;&gt; pressure = 100000 # Pa</span>
<span class="sd">    &gt;&gt;&gt; mu = 0.1 # Pa*s</span>
<span class="sd">    &gt;&gt;&gt; perm = pyLCM.perm.perm_1d(flow_front, time, Vf, pressure, mu) # m^2</span>
<span class="sd">    &gt;&gt;&gt; print(round(perm, 5))</span>
<span class="sd">    1.59596e-10</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

    <span class="n">Lf_sq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">flow_front</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="p">[</span><span class="n">skip</span><span class="p">:]</span>

    <span class="c1"># Linear fitting: returns a vector of coefficients (slope,intercept)</span>
    <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Lf_sq</span><span class="p">[</span><span class="n">skip</span><span class="p">:],</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># r-square</span>
    <span class="n">r_sq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Lf_sq</span><span class="p">[</span><span class="n">skip</span><span class="p">:])[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span>

    <span class="n">equation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">([</span><span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">])</span>  <span class="c1"># retrieve the equation</span>

    <span class="n">perm</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">Vf</span><span class="p">)</span> <span class="o">*</span> <span class="n">mu</span> <span class="o">*</span> <span class="n">slope</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">pressure</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">plot</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Lf_sq</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Experiments&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">equation</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Linear fitting&#39;</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Time $t$ VS Square of flow distance $L^2$&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time(s)&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Square of flow distance $L^2 (m^2)$&#39;</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">Lf_sq</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.5</span><span class="p">,</span>
                <span class="s1">&#39;y=</span><span class="si">{}</span><span class="s1"> </span><span class="se">\n\n</span><span class="s1"> $R^2$=</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">equation</span><span class="p">)[</span><span class="mi">2</span><span class="p">:],</span>
                                            <span class="nb">round</span><span class="p">(</span><span class="n">r_sq</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span>
                <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">perm</span></div>


<div class="viewcode-block" id="perm_scale"><a class="viewcode-back" href="../../../source/pyLCM.perm.html#pyLCM.perm.perm_1d.perm_scale">[docs]</a><span class="k">def</span> <span class="nf">perm_scale</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">f_s</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Permeability estimation of scaled porous media.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Belot, Igor, et al. &quot;A 3D additive manufacturing approach for the</span>
<span class="sd">    validation of a numerical wall-scale model of catalytic particulate</span>
<span class="sd">    filters.&quot; Chemical Engineering Journal 405 (2021): 126653.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    k : float</span>
<span class="sd">        Permeability of the unscaled porous media.</span>
<span class="sd">    f_s : float</span>
<span class="sd">        Scaling factor of the porous media.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    k_s : float</span>
<span class="sd">        Permeability of the scaled porous media.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">k</span> <span class="o">*</span> <span class="n">f_s</span> <span class="o">**</span> <span class="mi">2</span></div>


<div class="viewcode-block" id="piston_flow_rate"><a class="viewcode-back" href="../../../source/pyLCM.perm.html#pyLCM.perm.perm_1d.piston_flow_rate">[docs]</a><span class="k">def</span> <span class="nf">piston_flow_rate</span><span class="p">(</span><span class="n">velocity</span><span class="p">,</span> <span class="n">cross_section_area</span><span class="o">=</span><span class="mf">0.0048454</span><span class="p">,</span> <span class="n">liquid_density</span><span class="o">=</span><span class="mi">960</span><span class="p">,</span> <span class="n">alg</span><span class="o">=</span><span class="s2">&quot;mass&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the flow rate of piston pumps according to its area</span>
<span class="sd">    and pumping action velocity.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    velocity : float</span>
<span class="sd">        Pumping action velocity of the piston pump in m/s.</span>
<span class="sd">    cross_section_area : float</span>
<span class="sd">        Cross-section area of the piston pump (m^2).</span>
<span class="sd">    liquid_density : float</span>
<span class="sd">        Density of the liquid in kg/m^3.</span>
<span class="sd">    alg : str</span>
<span class="sd">        Algorithm to calculate the flow rate. Default is &quot;mass&quot;.</span>
<span class="sd">        The other option is &quot;volume&quot;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    flow_rate : float</span>
<span class="sd">        Flow rate of the piston pump.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">alg</span> <span class="o">==</span> <span class="s2">&quot;mass&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">velocity</span> <span class="o">*</span> <span class="n">cross_section_area</span> <span class="o">*</span> <span class="n">liquid_density</span>
    <span class="k">elif</span> <span class="n">alg</span> <span class="o">==</span> <span class="s2">&quot;volume&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">velocity</span> <span class="o">*</span> <span class="n">cross_section_area</span></div>


<div class="viewcode-block" id="pressure_drop"><a class="viewcode-back" href="../../../source/pyLCM.perm.html#pyLCM.perm.perm_1d.pressure_drop">[docs]</a><span class="k">def</span> <span class="nf">pressure_drop</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">area</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the pressure drop of a flow thorugh a porous media</span>
<span class="sd">    with a given flow rate, cross-section area and viscosity based</span>
<span class="sd">    on Darcy&#39;s law.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    q: float</span>
<span class="sd">        Flow rate in m^3/s</span>
<span class="sd">    area: float</span>
<span class="sd">        Cross-section area perpendicular to the flow in m^2.</span>
<span class="sd">    mu: float</span>
<span class="sd">        Viscosity of the fluid in Pa*s.</span>
<span class="sd">    k: float</span>
<span class="sd">        Permeability of the porous media in m^2.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dp: float</span>
<span class="sd">        Pressure drop across the porous media in Pa.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">q</span> <span class="o">*</span> <span class="n">mu</span> <span class="o">/</span> <span class="p">(</span><span class="n">area</span> <span class="o">*</span> <span class="n">k</span><span class="p">)</span></div>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">k</span> <span class="o">=</span> <span class="mf">1e-11</span>  <span class="c1"># m^2</span>
    <span class="n">p</span> <span class="o">=</span> <span class="mf">1e5</span>  <span class="c1"># Pa</span>
    <span class="n">phi</span> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c1"># porosity</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="mf">0.1</span>  <span class="c1"># Pa*s</span>
    <span class="n">s</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># m</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The flow distance at 25000 seconds is </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">flow_dist</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="mi">25000</span><span class="p">)))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The one dimensional filling time for a 1 meter length porous meida is </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">filling_time</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">s</span><span class="p">)))</span>

    <span class="n">q</span> <span class="o">=</span> <span class="mf">4.5019</span> <span class="o">/</span> <span class="mi">1000</span>  <span class="c1"># kg/s</span>
    <span class="n">p</span> <span class="o">=</span> <span class="mi">44697</span>  <span class="c1"># Pa</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="mf">0.118</span>  <span class="c1"># Pa*s</span>
    <span class="n">h</span> <span class="o">=</span> <span class="mf">0.00301</span>  <span class="c1"># m</span>
    <span class="n">A</span> <span class="o">=</span> <span class="mf">3.14159</span> <span class="o">*</span> <span class="p">(</span><span class="mi">57</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>  <span class="c1"># m^2</span>
    <span class="n">rho</span> <span class="o">=</span> <span class="mi">960</span>  <span class="c1"># kg/m^3</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">saturated</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">mu</span><span class="p">))</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Bin Yang.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>